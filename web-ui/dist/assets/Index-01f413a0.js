import{d as N,r as c,a as b,i as B,k as i,M as F,o as T,g as M,e as k,f as a,w as l,u as q,b as r,h as o,c as _,t as g,l as U}from"./index-697510e5.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";const R=N({data(){const e={menuName:"",name:"",description:"",stat:void 0},t=c({...e}),u=c([]),v=c([]),p=b(!1),y=b(!1),m=c({name:"",description:"",stat:1}),s=b(!1),f=b(!1),d=c({id:"",name:"",description:"",stat:1});return{formState:t,data:u,roleSource:v,createModalVisible:p,createLoading:y,createForm:m,editModalVisible:s,editLoading:f,editForm:d,defaultFormState:e}},computed:{...B(q,["tokenVal"]),tableData:function(){return this.data},headers:function(){return{Authorization:"xtoken "+this.tokenVal}},uploadUrl:function(){return this.$cfg.rootUrl()+"/personkit/disk/file/import"}},methods:{handleFinish(){this.query()},handleReset(){Object.assign(this.formState,this.defaultFormState),this.pagination.current=1,this.query()},query(){this.$http.request({url:"/personkit/sys/role/page",data:{num:this.pagination.current,query:this.formState,size:this.pagination.pageSize}}).then(e=>{this.pagination.current=e.num,this.pagination.total=e.total,this.data=c(e.data)}).catch(e=>{console.error("查询角色失败:",e),i.error("查询角色数据失败")})},handleDelete(e){F.confirm({title:"确认删除",content:`确定要删除角色 "${e.name}" 吗？此操作不可恢复。`,okText:"确认",cancelText:"取消",okType:"danger",onOk:()=>{this.$http.request({url:"/personkit/sys/role/deletes",method:"post",data:{ids:[e.id]}}).then(t=>{i.success("删除成功"),this.query()}).catch(t=>{console.error("删除失败:",t),i.error("删除失败")})}})},handleToggleStatus(e){if(e.stat===-1){i.warning("系统角色状态不可修改");return}const t=e.stat===1?0:1,u=t===1?"启用":"禁用",v=e.stat===1?"启用":"禁用";F.confirm({title:"确认操作",content:`确定要将角色 "${e.name}" 从${v}状态改为${u}状态吗？`,okText:"确认",cancelText:"取消",onOk:()=>{this.$http.request({url:"/personkit/sys/role/update",method:"post",data:{id:e.id,stat:t}}).then(p=>{i.success(`角色${u}成功`),e.stat=t,this.query()}).catch(p=>{console.error("切换状态失败:",p),i.error(`${u}失败`)})}})},showCreateModal(){this.createForm.name="",this.createForm.description="",this.createForm.stat=this.ROLE_STATUS.ENABLE.value,this.createModalVisible=!0},handleCreate(){if(!this.createForm.name.trim()){i.warning("请输入角色名称");return}this.createLoading=!0,this.$http.request({url:"/personkit/sys/role/save",method:"post",data:this.createForm}).then(e=>{i.success("增加角色成功"),this.createModalVisible=!1,this.query()}).catch(e=>{console.error("增加角色失败:",e),i.error("增加角色失败")}).finally(()=>{this.createLoading=!1})},handleCreateCancel(){this.createModalVisible=!1},showEditModal(e){this.editForm.id=e.id,this.editForm.name=e.name,this.editForm.description=e.description||"",this.editForm.stat=e.stat,this.editModalVisible=!0},handleEdit(){if(!this.editForm.name.trim()){i.warning("请输入角色名称");return}this.editLoading=!0,this.$http.request({url:"/personkit/sys/role/update",method:"post",data:this.editForm}).then(e=>{i.success("编辑角色成功"),this.editModalVisible=!1,this.query()}).catch(e=>{console.error("编辑角色失败:",e),i.error("编辑角色失败")}).finally(()=>{this.editLoading=!1})},handleEditCancel(){this.editModalVisible=!1},handleChange(e){e.file.status!=="uploading"&&console.log(e.file,e.fileList),e.file.status==="done"?this.$msg.success(`${e.file.name} file uploaded successfully`):e.file.status==="error"&&this.$msg.error(`${e.file.name} file upload failed.`),this.query()},onPaginationChange(e,t){this.pagination.current=e,this.query()},showDetail(e){sessionStorage.setItem("current_view_file",JSON.stringify(e)),this.$router.push({name:"data_source_detail",query:{record:e.id}})},modifyMenus(e){sessionStorage.setItem("current_role_for_menu",JSON.stringify({id:e.id,name:e.name,description:e.description,stat:e.stat})),this.$router.push({name:"role_menu_management",query:{roleId:e.id}})}},mounted(){this.query()},setup(){const e={INIT:{label:"系统",value:-1,color:"blue"},ENABLE:{label:"启用",value:1,color:"green"},DISABLE:{label:"禁用",value:0,color:"red"}},t=f=>({[-1]:e.INIT,1:e.ENABLE,0:e.DISABLE})[f]||e.DISABLE,u=[{title:"角色名称",dataIndex:"name",key:"name",align:"center"},{title:"角色状态",dataIndex:"stat",key:"stat",align:"center",width:100},{title:"角色描述",dataIndex:"description",key:"description",ellipsis:!0,align:"center"},{title:"操作",dataIndex:"action",key:"action",width:400,align:"center",fixed:"right"}],v={current:1,total:0,pageSize:10},p=b([]),y={style:{width:"80px"}},m={span:14},s=c([{label:e.INIT.label,value:e.INIT.value},{label:e.ENABLE.label,value:e.ENABLE.value},{label:e.DISABLE.label,value:e.DISABLE.value}]);return{columns:u,pagination:v,fileList:p,labelCol:y,wrapperCol:m,statusOptions:s,ROLE_STATUS:e,getRoleStatus:t}}}),D={class:"page-content-wrapper"},z={class:"search-area"},J={class:"content-min-height"},P={style:{"margin-top":"15px",float:"right"}};function j(e,t,u,v,p,y){const m=r("a-input"),s=r("a-form-item"),f=r("a-select"),d=r("a-button"),L=r("a-space"),E=r("a-form"),w=r("a-tag"),$=r("a-table"),O=r("a-pagination"),C=r("a-textarea"),S=r("a-select-option"),I=r("a-modal");return T(),M("div",D,[k("div",z,[a(E,{layout:"inline",name:"basic",autocomplete:"off",model:e.formState,onFinish:e.handleFinish,"label-col":e.labelCol},{default:l(()=>[a(s,{label:"角色名称",name:"name",class:"input"},{default:l(()=>[a(m,{allowClear:"",value:e.formState.name,"onUpdate:value":t[0]||(t[0]=n=>e.formState.name=n),placeholder:"角色名称，模糊查询"},null,8,["value"])]),_:1}),a(s,{label:"角色状态",name:"stat",class:"input"},{default:l(()=>[a(f,{allowClear:"",style:{width:"180px"},placeholder:"请选择状态",value:e.formState.stat,"onUpdate:value":t[1]||(t[1]=n=>e.formState.stat=n),options:e.statusOptions},null,8,["value","options"])]),_:1}),a(L,{class:"input"},{default:l(()=>[a(d,{type:"primary","html-type":"submit"},{default:l(()=>[...t[11]||(t[11]=[o(" 搜索 ",-1)])]),_:1}),a(d,{onClick:e.handleReset},{default:l(()=>[...t[12]||(t[12]=[o(" 重置 ",-1)])]),_:1},8,["onClick"]),a(d,{type:"primary",onClick:e.showCreateModal},{default:l(()=>[...t[13]||(t[13]=[o(" 增加角色 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","onFinish","label-col"])]),k("div",J,[a($,{columns:e.columns,"data-source":e.tableData,pagination:!1,size:"small",scroll:{x:1500}},{bodyCell:l(({column:n,record:h})=>[n.dataIndex==="stat"?(T(),_(w,{key:0,color:h.stat===1?"green":h.stat===0?"red":"blue"},{default:l(()=>[o(g(h.stat===1?"启用":h.stat===0?"禁用":"系统"),1)]),_:2},1032,["color"])):U("",!0),n.dataIndex==="action"?(T(),_(L,{key:1,size:2},{default:l(()=>[a(d,{type:"link",danger:"",onClick:A=>e.handleDelete(h)},{default:l(()=>[...t[14]||(t[14]=[o("删除",-1)])]),_:1},8,["onClick"]),a(d,{type:"link",onClick:A=>e.showEditModal(h)},{default:l(()=>[...t[15]||(t[15]=[o("编辑",-1)])]),_:1},8,["onClick"]),a(d,{type:"link",onClick:A=>e.modifyMenus(h)},{default:l(()=>[...t[16]||(t[16]=[o("修改菜单",-1)])]),_:1},8,["onClick"])]),_:2},1024)):U("",!0)]),_:1},8,["columns","data-source"]),k("div",P,[a(O,{current:e.pagination.current,"onUpdate:current":t[2]||(t[2]=n=>e.pagination.current=n),total:e.pagination.total,"show-total":n=>`共 ${n} 条数据`,onChange:e.onPaginationChange},null,8,["current","total","show-total","onChange"])])]),a(I,{open:e.createModalVisible,"onUpdate:open":t[6]||(t[6]=n=>e.createModalVisible=n),title:"增加角色",onOk:e.handleCreate,onCancel:e.handleCreateCancel,"confirm-loading":e.createLoading},{default:l(()=>[a(E,{model:e.createForm,"label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[a(s,{label:"角色名称",required:""},{default:l(()=>[a(m,{value:e.createForm.name,"onUpdate:value":t[3]||(t[3]=n=>e.createForm.name=n),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),a(s,{label:"角色描述"},{default:l(()=>[a(C,{value:e.createForm.description,"onUpdate:value":t[4]||(t[4]=n=>e.createForm.description=n),placeholder:"请输入角色描述",rows:4},null,8,["value"])]),_:1}),a(s,{label:"角色状态"},{default:l(()=>[a(f,{value:e.createForm.stat,"onUpdate:value":t[5]||(t[5]=n=>e.createForm.stat=n),placeholder:"请选择状态"},{default:l(()=>[a(S,{value:e.ROLE_STATUS.INIT.value,disabled:!0},{default:l(()=>[o(g(e.ROLE_STATUS.INIT.label),1)]),_:1},8,["value"]),a(S,{value:e.ROLE_STATUS.ENABLE.value},{default:l(()=>[o(g(e.ROLE_STATUS.ENABLE.label),1)]),_:1},8,["value"]),a(S,{value:e.ROLE_STATUS.DISABLE.value},{default:l(()=>[o(g(e.ROLE_STATUS.DISABLE.label),1)]),_:1},8,["value"])]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","onOk","onCancel","confirm-loading"]),a(I,{open:e.editModalVisible,"onUpdate:open":t[10]||(t[10]=n=>e.editModalVisible=n),title:"编辑角色",onOk:e.handleEdit,onCancel:e.handleEditCancel,"confirm-loading":e.editLoading},{default:l(()=>[a(E,{model:e.editForm,"label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[a(s,{label:"角色名称",required:""},{default:l(()=>[a(m,{value:e.editForm.name,"onUpdate:value":t[7]||(t[7]=n=>e.editForm.name=n),placeholder:"请输入角色名称"},null,8,["value"])]),_:1}),a(s,{label:"角色描述"},{default:l(()=>[a(C,{value:e.editForm.description,"onUpdate:value":t[8]||(t[8]=n=>e.editForm.description=n),placeholder:"请输入角色描述",rows:4},null,8,["value"])]),_:1}),a(s,{label:"角色状态"},{default:l(()=>[a(f,{value:e.editForm.stat,"onUpdate:value":t[9]||(t[9]=n=>e.editForm.stat=n),placeholder:"请选择状态"},{default:l(()=>[a(S,{value:e.ROLE_STATUS.INIT.value,disabled:!0},{default:l(()=>[o(g(e.ROLE_STATUS.INIT.label),1)]),_:1},8,["value"]),a(S,{value:e.ROLE_STATUS.ENABLE.value},{default:l(()=>[o(g(e.ROLE_STATUS.ENABLE.label),1)]),_:1},8,["value"]),a(S,{value:e.ROLE_STATUS.DISABLE.value},{default:l(()=>[o(g(e.ROLE_STATUS.DISABLE.label),1)]),_:1},8,["value"])]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","onOk","onCancel","confirm-loading"])])}const K=V(R,[["render",j],["__scopeId","data-v-bf79429d"]]);export{K as default};
