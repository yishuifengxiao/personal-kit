import{P as N}from"./relation-graph-0549b3aa.js";import{_ as k}from"./_plugin-vue_export-helper-c27b6911.js";import{d as w,a as g,r as l,o as b,g as C,f as o,w as n,b as a,e as i,t as S,h as d}from"./index-bc318887.js";const $=w({props:{id:String},data(){return{ontId:g(""),ontOptions:l([]),graphOptions:l({})}},methods:{onOntValChange(e){this.ontId=g(e),this.$http.request({url:"/personkit/graph/ont/detail",data:{id:e}}).then(t=>{this.graphOptions=l(JSON.parse(t)),this.$refs.graphRef.setJsonData(this.graphOptions)}).catch(t=>console.log(t))},handleSearch(e){this.$http.request({url:"/personkit/graph/ont/page",data:{num:1,query:{ontologyName:e},size:10}}).then(t=>{const u=t.data.map(h=>({label:h.ontologyName,value:h.id}));this.ontOptions=l(u)}).catch(t=>console.log(t))},onNodeClick(e){debugger},nextStep(){if(!this.graphOptions.graphName)return this.$msg.error("图谱名称不能为空"),!1;if(this.ontId.length===0)return this.$msg.error("请先配置本体"),!1;const e=this.id?"/personkit/graph/define/update":"/personkit/graph/define/save";this.$http.request({url:e,data:this.graphOptions}).then(t=>{this.$router.push({name:"graph_config_data",query:{ontId:t}})}).catch(t=>console.log(t))}},mounted(){this.handleSearch("")},setup(){return{steps:[{title:"配置本体",description:""},{title:"配置数据源",description:"",subTitle:"配置数据抽取"},{title:"配置映射",description:""},{title:"配置融合",description:"可选"},{title:"生成图谱",description:""}],graphOptions:{backgroundImageNoRepeat:!0,backgrounImageNoRepeat:!0,isMoveByParentNode:!0,defaultExpandHolderPosition:"top",defaultLineShape:3,defaultJunctionPoint:"ltrb",placeOtherGroup:!0,allowSwitchLineShape:!0,allowSwitchJunctionPoint:!0,moveToCenterWhenRefresh:!0,layouts:[{label:"中心",layoutName:"center",distance_coefficient:1}]}}},components:{RelationGraph:N}}),R={style:{height:"100%"}},I={id:"mountNode",ref:"myPage",style:{border:"gray dashed thin",height:"100%"}},x={style:{color:"forestgreen","font-size":"16px",position:"absolute",width:"160px",height:"25px","line-height":"25px","margin-top":"5px","margin-left":"-48px","text-align":"center","background-color":"rgba(66, 187, 66, 0.2)"}};function P(e,t,u,h,G,q){const c=a("a-steps"),f=a("a-divider"),m=a("RelationGraph"),r=a("a-col"),_=a("a-input"),p=a("a-row"),v=a("a-textarea"),y=a("a-select"),O=a("a-button");return b(),C("div",R,[o(c,{type:"navigation",current:0,items:e.steps},null,8,["items"]),o(f),o(p,{style:{height:"89%"}},{default:n(()=>[o(r,{span:12,style:{height:"100%"}},{default:n(()=>[i("div",I,[o(m,{ref:"graphRef",options:e.graphOptions,"on-node-click":e.onNodeClick},{node:n(({node:s})=>[i("div",null,[t[3]||(t[3]=i("div",{class:"c-my-rg-node"},null,-1)),i("div",x,S(s.text),1)])]),_:1},8,["options","on-node-click"])],512)]),_:1}),o(r,{span:12},{default:n(()=>[o(p,null,{default:n(()=>[o(r,{span:20,offset:2},{default:n(()=>[i("div",null,[t[4]||(t[4]=d(" 图谱名称: ",-1)),o(_,{value:e.graphOptions.graphName,"onUpdate:value":t[0]||(t[0]=s=>e.graphOptions.graphName=s),style:{width:"90%"},placeholder:"图谱名称"},null,8,["value"])])]),_:1})]),_:1}),o(p,{style:{"margin-top":"1rem"}},{default:n(()=>[o(r,{span:20,offset:2},{default:n(()=>[i("div",null,[t[5]||(t[5]=d(" 图谱描述: ",-1)),o(v,{value:e.graphOptions.description,"onUpdate:value":t[1]||(t[1]=s=>e.graphOptions.description=s),style:{width:"90%"},placeholder:"图谱描述","auto-size":{minRows:4,maxRows:6}},null,8,["value"])])]),_:1})]),_:1}),o(p,{style:{"margin-top":"1rem"}},{default:n(()=>[o(r,{span:20,offset:2},{default:n(()=>[i("div",null,[t[6]||(t[6]=d(" 选择本体: ",-1)),o(y,{ref:"select",placeholder:"选择本体",onSearch:e.handleSearch,"show-search":"",value:e.ontId,"onUpdate:value":t[2]||(t[2]=s=>e.ontId=s),style:{width:"90%"},options:e.ontOptions,onChange:e.onOntValChange},null,8,["onSearch","value","options","onChange"])])]),_:1})]),_:1}),o(p,{style:{"margin-top":"3rem"}},{default:n(()=>[o(r,{span:20,offset:2},{default:n(()=>[o(O,{type:"primary",onClick:e.nextStep},{default:n(()=>[...t[7]||(t[7]=[d("保存配置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})])}const z=k($,[["render",P],["__scopeId","data-v-d85308e0"]]);export{z as default};
