import{d as S,r as l,i as I,M as $,k as g,a as x,o as y,g as q,f as a,w as n,e as c,u as N,b as i,h as d,c as U,l as T}from"./index-8cadae33.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import{U as V}from"./UserOutlined-839a9000.js";const O=S({data(){const e=l({}),t=l([]),r=l([]);return{formState:e,data:t,roleSource:r}},computed:{...I(N,["tokenVal"]),tableData:function(){return this.data},headers:function(){return{Authorization:"xtoken "+this.tokenVal}},uploadUrl:function(){return this.$cfg.rootUrl()+"/personkit/disk/file/import"}},methods:{handleFinish(){this.query()},handleReset(){this.formState=l({}),this.pagination.current=1,this.query()},handleClear(){$.confirm({title:"确认清空",content:"确定要清空所有登录记录吗？此操作不可恢复。",okText:"确认",cancelText:"取消",okType:"danger",onOk:()=>{this.$http.request({url:"/personkit/record/personal/loginRecord/clear",method:"post"}).then(()=>{g.success("清空数据成功"),this.query()}).catch(e=>{console.error("清空数据失败:",e),g.error("清空数据失败")})}})},query(){this.$http.request({url:"/personkit/record/personal/login/page",data:{num:this.pagination.current,query:this.formState,size:this.pagination.pageSize}}).then(e=>{this.pagination.current=e.num,this.pagination.total=e.total,this.data=l(e.data)}).catch(e=>console.log(e))},handleChange(e){e.file.status!=="uploading"&&console.log(e.file,e.fileList),e.file.status==="done"?this.$msg.success(`${e.file.name} file uploaded successfully`):e.file.status==="error"&&this.$msg.error(`${e.file.name} file upload failed.`),this.query()},onPaginationChange(e,t){this.pagination.current=e,this.query()},showDetail(e){sessionStorage.setItem("current_view_file",JSON.stringify(e)),this.$router.push({name:"data_source_detail",query:{record:e.id}})}},components:{UserOutlined:V},mounted(){this.query()},setup(){const e=[{title:"操作类型",dataIndex:"strategyName",key:"strategyName",align:"center",fixed:"left",width:150},{title:"操作用户",dataIndex:"username",key:"username",align:"center",width:150,fixed:"left"},{title:"IP地址",dataIndex:"ip",key:"ip",ellipsis:!0,align:"center",width:100,fixed:"left"},{title:"来源",dataIndex:"referer",key:"referer",ellipsis:!0,width:100,align:"center"},{title:"浏览器",dataIndex:"userAgent",key:"userAgent",ellipsis:!0,width:150,align:"center"},{title:"时间",dataIndex:"createTime",key:"createTime",ellipsis:!0,width:150,align:"center"},{title:"处理信息",dataIndex:"msg",key:"msg",width:150,ellipsis:!0,align:"center"},{title:"操作",dataIndex:"action",key:"action",width:300,align:"center",fixed:"right"}],t={current:1,total:0,pageSize:10},r=x([]),m={style:{width:"80px"}},f={span:14},h=l([{label:"认证成功",value:0},{label:"认证失败",value:1}]);return{columns:e,pagination:t,fileList:r,labelCol:m,wrapperCol:f,statusOptions:h}}}),B={class:"high-data-table"},D={style:{"margin-top":"16px"}},F={style:{"margin-top":"15px",float:"right"}};function A(e,t,r,m,f,h){const _=i("a-select"),s=i("a-form-item"),k=i("a-input"),u=i("a-button"),C=i("a-form"),w=i("a-space"),b=i("a-table"),v=i("a-pagination");return y(),q("div",B,[a(C,{layout:"inline",name:"basic",autocomplete:"off",model:e.formState,onFinish:e.handleFinish},{default:n(()=>[a(s,{label:"类型",name:"username"},{default:n(()=>[a(_,{allowClear:"",style:{width:"180px"},placeholder:"状态",value:e.formState.auth,"onUpdate:value":t[0]||(t[0]=o=>e.formState.auth=o),options:e.statusOptions},null,8,["value","options"])]),_:1}),a(s,{label:"账号",name:"nickname"},{default:n(()=>[a(k,{allowClear:"",value:e.formState.nickname,"onUpdate:value":t[1]||(t[1]=o=>e.formState.nickname=o),placeholder:"昵称，模糊查询"},null,8,["value"])]),_:1}),a(s,null,{default:n(()=>[a(u,{type:"primary","html-type":"submit"},{default:n(()=>[...t[3]||(t[3]=[d(" 搜索 ",-1)])]),_:1})]),_:1}),a(s,null,{default:n(()=>[a(u,{onClick:e.handleReset},{default:n(()=>[...t[4]||(t[4]=[d(" 重置 ",-1)])]),_:1},8,["onClick"])]),_:1}),a(s,null,{default:n(()=>[a(u,{type:"dashed",danger:"",onClick:e.handleClear},{default:n(()=>[...t[5]||(t[5]=[d(" 清空 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","onFinish"]),c("div",D,[a(b,{columns:e.columns,"data-source":e.tableData,pagination:!1,size:"small",scroll:{x:1500}},{bodyCell:n(({column:o,record:p})=>[o.dataIndex==="action"?(y(),U(w,{key:0},{default:n(()=>[a(u,{type:"link",onClick:P=>e.showDetail(p),disabled:p.stat!=2||p.actualTotalNum===0},{default:n(()=>[...t[6]||(t[6]=[d("详情",-1)])]),_:1},8,["onClick","disabled"]),t[7]||(t[7]=c("a",null,"删除",-1))]),_:2},1024)):T("",!0)]),_:1},8,["columns","data-source"]),c("div",F,[a(v,{current:e.pagination.current,"onUpdate:current":t[2]||(t[2]=o=>e.pagination.current=o),total:e.pagination.total,"show-total":o=>`共 ${o} 条数据`,onChange:e.onPaginationChange},null,8,["current","total","show-total","onChange"])])])])}const E=z(O,[["render",A],["__scopeId","data-v-4e9a713c"]]);export{E as default};
