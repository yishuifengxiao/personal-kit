import{d as _,N as j,z as I,P as X,i as E,a as F,r as H,o as g,g as S,e as d,f as a,w as l,y as b,b as u,h as r,F as J,q as K,c as R,s as q}from"./index-64e3746b.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const Q=_({name:"AddSpider",components:{ArrowLeftOutlined:j,DeleteOutlined:I,PlusOutlined:X},setup(){const t=E(),e=F(),D=F(!1),y=H({name:"",description:"",targetUrl:"",dataType:"",crawlMode:"single",depth:1,concurrent:5,interval:1,timeout:30,selectors:[{name:"title",type:"css",value:"h1"},{name:"content",type:"css",value:".content"}],dataClean:["trim"],storageType:"database",tableName:"",fileFormat:"json",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",headers:"",cookies:"",proxy:""});return{formRef:e,formData:y,formRules:{name:[{required:!0,message:"请输入爬虫名称",trigger:"blur"},{min:2,max:50,message:"名称长度应在2-50个字符之间",trigger:"blur"}],description:[{required:!0,message:"请输入爬虫描述",trigger:"blur"}],targetUrl:[{required:!0,message:"请输入目标网站URL",trigger:"blur"},{pattern:/^https?:\/\/.+/,message:"请输入有效的URL地址",trigger:"blur"}],dataType:[{required:!0,message:"请选择数据类型",trigger:"change"}],crawlMode:[{required:!0,message:"请选择爬取模式",trigger:"change"}],depth:[{required:!0,message:"请输入爬取深度",trigger:"blur"}],concurrent:[{required:!0,message:"请输入并发数量",trigger:"blur"}],interval:[{required:!0,message:"请输入请求间隔",trigger:"blur"}],timeout:[{required:!0,message:"请输入超时时间",trigger:"blur"}],storageType:[{required:!0,message:"请选择存储方式",trigger:"change"}],tableName:[{required:!0,message:"请输入数据库表名",trigger:"blur"}]},submitLoading:D,addSelector:()=>{y.selectors.push({name:"",type:"css",value:""})},removeSelector:n=>{y.selectors.splice(n,1)},handleSubmit:async()=>{try{await e.value.validate(),D.value=!0,setTimeout(()=>{b.success("爬虫创建成功"),D.value=!1,t.push("/view/all_spider")},2e3)}catch(n){console.error("表单验证失败:",n)}},handleTest:async()=>{try{await e.value.validateFields(["targetUrl"]),b.loading("正在测试连接...",0),setTimeout(()=>{b.destroy(),b.success("连接测试成功")},1500)}catch{b.error("请先填写目标网站URL")}},handleReset:()=>{e.value.resetFields(),b.success("表单已重置")}}}}),Y={class:"add-spider-container"},Z={class:"page-header"},x={class:"header-left"},h={class:"form-container"},c={class:"selector-config"};function ee(t,e,D,y,M,$){const N=u("arrow-left-outlined"),i=u("a-button"),p=u("a-divider"),m=u("a-input"),n=u("a-form-item"),U=u("a-textarea"),s=u("a-select-option"),C=u("a-select"),f=u("a-radio"),A=u("a-radio-group"),k=u("a-input-number"),w=u("a-col"),V=u("delete-outlined"),B=u("a-row"),O=u("plus-outlined"),T=u("a-checkbox"),P=u("a-checkbox-group"),z=u("a-space"),W=u("a-form");return g(),S("div",Y,[d("div",Z,[d("div",x,[a(i,{onClick:e[0]||(e[0]=o=>t.$router.back()),class:"back-btn"},{default:l(()=>[a(N),e[18]||(e[18]=r(" 返回 ",-1))]),_:1}),e[19]||(e[19]=d("span",{class:"page-title"},"添加爬虫",-1))])]),d("div",h,[a(W,{ref:"formRef",model:t.formData,rules:t.formRules,"label-col":{span:4},"wrapper-col":{span:16},size:"large"},{default:l(()=>[a(p,{orientation:"left"},{default:l(()=>[...e[20]||(e[20]=[r("基本信息",-1)])]),_:1}),a(n,{label:"爬虫名称",name:"name"},{default:l(()=>[a(m,{value:t.formData.name,"onUpdate:value":e[1]||(e[1]=o=>t.formData.name=o),placeholder:"请输入爬虫名称"},null,8,["value"])]),_:1}),a(n,{label:"爬虫描述",name:"description"},{default:l(()=>[a(U,{value:t.formData.description,"onUpdate:value":e[2]||(e[2]=o=>t.formData.description=o),placeholder:"请输入爬虫描述",rows:3},null,8,["value"])]),_:1}),a(n,{label:"目标网站",name:"targetUrl"},{default:l(()=>[a(m,{value:t.formData.targetUrl,"onUpdate:value":e[3]||(e[3]=o=>t.formData.targetUrl=o),placeholder:"请输入目标网站URL"},null,8,["value"])]),_:1}),a(n,{label:"数据类型",name:"dataType"},{default:l(()=>[a(C,{value:t.formData.dataType,"onUpdate:value":e[4]||(e[4]=o=>t.formData.dataType=o),placeholder:"请选择数据类型"},{default:l(()=>[a(s,{value:"article"},{default:l(()=>[...e[21]||(e[21]=[r("文章",-1)])]),_:1}),a(s,{value:"image"},{default:l(()=>[...e[22]||(e[22]=[r("图片",-1)])]),_:1}),a(s,{value:"video"},{default:l(()=>[...e[23]||(e[23]=[r("视频",-1)])]),_:1}),a(s,{value:"product"},{default:l(()=>[...e[24]||(e[24]=[r("商品",-1)])]),_:1}),a(s,{value:"news"},{default:l(()=>[...e[25]||(e[25]=[r("新闻",-1)])]),_:1}),a(s,{value:"social"},{default:l(()=>[...e[26]||(e[26]=[r("社交媒体",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),a(p,{orientation:"left"},{default:l(()=>[...e[27]||(e[27]=[r("爬取配置",-1)])]),_:1}),a(n,{label:"爬取模式",name:"crawlMode"},{default:l(()=>[a(A,{value:t.formData.crawlMode,"onUpdate:value":e[5]||(e[5]=o=>t.formData.crawlMode=o)},{default:l(()=>[a(f,{value:"single"},{default:l(()=>[...e[28]||(e[28]=[r("单页面",-1)])]),_:1}),a(f,{value:"multi"},{default:l(()=>[...e[29]||(e[29]=[r("多页面",-1)])]),_:1}),a(f,{value:"recursive"},{default:l(()=>[...e[30]||(e[30]=[r("递归爬取",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),a(n,{label:"爬取深度",name:"depth"},{default:l(()=>[a(k,{value:t.formData.depth,"onUpdate:value":e[6]||(e[6]=o=>t.formData.depth=o),min:1,max:10},null,8,["value"]),e[31]||(e[31]=d("span",{class:"help-text"},"递归爬取时的最大深度",-1))]),_:1}),a(n,{label:"并发数量",name:"concurrent"},{default:l(()=>[a(k,{value:t.formData.concurrent,"onUpdate:value":e[7]||(e[7]=o=>t.formData.concurrent=o),min:1,max:50},null,8,["value"]),e[32]||(e[32]=d("span",{class:"help-text"},"同时进行的爬取任务数量",-1))]),_:1}),a(n,{label:"请求间隔",name:"interval"},{default:l(()=>[a(k,{value:t.formData.interval,"onUpdate:value":e[8]||(e[8]=o=>t.formData.interval=o),min:0,max:60},null,8,["value"]),e[33]||(e[33]=d("span",{class:"help-text"},"每次请求之间的间隔时间（秒）",-1))]),_:1}),a(n,{label:"超时时间",name:"timeout"},{default:l(()=>[a(k,{value:t.formData.timeout,"onUpdate:value":e[9]||(e[9]=o=>t.formData.timeout=o),min:5,max:300},null,8,["value"]),e[34]||(e[34]=d("span",{class:"help-text"},"单个请求的超时时间（秒）",-1))]),_:1}),a(p,{orientation:"left"},{default:l(()=>[...e[35]||(e[35]=[r("数据提取配置",-1)])]),_:1}),a(n,{label:"选择器配置",name:"selectors"},{default:l(()=>[d("div",c,[(g(!0),S(J,null,K(t.formData.selectors,(o,L)=>(g(),S("div",{key:L,class:"selector-item"},[a(B,{gutter:8},{default:l(()=>[a(w,{span:6},{default:l(()=>[a(m,{value:o.name,"onUpdate:value":v=>o.name=v,placeholder:"字段名称"},null,8,["value","onUpdate:value"])]),_:2},1024),a(w,{span:8},{default:l(()=>[a(C,{value:o.type,"onUpdate:value":v=>o.type=v,placeholder:"选择器类型"},{default:l(()=>[a(s,{value:"css"},{default:l(()=>[...e[36]||(e[36]=[r("CSS选择器",-1)])]),_:1}),a(s,{value:"xpath"},{default:l(()=>[...e[37]||(e[37]=[r("XPath",-1)])]),_:1}),a(s,{value:"regex"},{default:l(()=>[...e[38]||(e[38]=[r("正则表达式",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])]),_:2},1024),a(w,{span:8},{default:l(()=>[a(m,{value:o.value,"onUpdate:value":v=>o.value=v,placeholder:"选择器值"},null,8,["value","onUpdate:value"])]),_:2},1024),a(w,{span:2},{default:l(()=>[t.formData.selectors.length>1?(g(),R(i,{key:0,type:"link",danger:"",onClick:v=>t.removeSelector(L)},{default:l(()=>[a(V)]),_:1},8,["onClick"])):q("",!0)]),_:2},1024)]),_:2},1024)]))),128)),a(i,{type:"dashed",onClick:t.addSelector,style:{width:"100%"}},{default:l(()=>[a(O),e[39]||(e[39]=r(" 添加选择器 ",-1))]),_:1},8,["onClick"])])]),_:1}),a(n,{label:"数据清洗",name:"dataClean"},{default:l(()=>[a(P,{value:t.formData.dataClean,"onUpdate:value":e[10]||(e[10]=o=>t.formData.dataClean=o)},{default:l(()=>[a(T,{value:"trim"},{default:l(()=>[...e[40]||(e[40]=[r("去除空白字符",-1)])]),_:1}),a(T,{value:"html"},{default:l(()=>[...e[41]||(e[41]=[r("去除HTML标签",-1)])]),_:1}),a(T,{value:"special"},{default:l(()=>[...e[42]||(e[42]=[r("去除特殊字符",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),a(p,{orientation:"left"},{default:l(()=>[...e[43]||(e[43]=[r("存储配置",-1)])]),_:1}),a(n,{label:"存储方式",name:"storageType"},{default:l(()=>[a(A,{value:t.formData.storageType,"onUpdate:value":e[11]||(e[11]=o=>t.formData.storageType=o)},{default:l(()=>[a(f,{value:"database"},{default:l(()=>[...e[44]||(e[44]=[r("数据库存储",-1)])]),_:1}),a(f,{value:"file"},{default:l(()=>[...e[45]||(e[45]=[r("文件存储",-1)])]),_:1}),a(f,{value:"api"},{default:l(()=>[...e[46]||(e[46]=[r("API接口",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t.formData.storageType==="database"?(g(),R(n,{key:0,label:"数据库表",name:"tableName"},{default:l(()=>[a(m,{value:t.formData.tableName,"onUpdate:value":e[12]||(e[12]=o=>t.formData.tableName=o),placeholder:"请输入数据库表名"},null,8,["value"])]),_:1})):q("",!0),t.formData.storageType==="file"?(g(),R(n,{key:1,label:"文件格式",name:"fileFormat"},{default:l(()=>[a(C,{value:t.formData.fileFormat,"onUpdate:value":e[13]||(e[13]=o=>t.formData.fileFormat=o),placeholder:"请选择文件格式"},{default:l(()=>[a(s,{value:"json"},{default:l(()=>[...e[47]||(e[47]=[r("JSON",-1)])]),_:1}),a(s,{value:"csv"},{default:l(()=>[...e[48]||(e[48]=[r("CSV",-1)])]),_:1}),a(s,{value:"xml"},{default:l(()=>[...e[49]||(e[49]=[r("XML",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):q("",!0),a(p,{orientation:"left"},{default:l(()=>[...e[50]||(e[50]=[r("高级配置",-1)])]),_:1}),a(n,{label:"用户代理",name:"userAgent"},{default:l(()=>[a(U,{value:t.formData.userAgent,"onUpdate:value":e[14]||(e[14]=o=>t.formData.userAgent=o),placeholder:"请输入用户代理字符串",rows:2},null,8,["value"])]),_:1}),a(n,{label:"请求头",name:"headers"},{default:l(()=>[a(U,{value:t.formData.headers,"onUpdate:value":e[15]||(e[15]=o=>t.formData.headers=o),placeholder:"请输入自定义请求头，格式：key: value",rows:3},null,8,["value"])]),_:1}),a(n,{label:"Cookie",name:"cookies"},{default:l(()=>[a(U,{value:t.formData.cookies,"onUpdate:value":e[16]||(e[16]=o=>t.formData.cookies=o),placeholder:"请输入Cookie字符串",rows:2},null,8,["value"])]),_:1}),a(n,{label:"代理设置",name:"proxy"},{default:l(()=>[a(m,{value:t.formData.proxy,"onUpdate:value":e[17]||(e[17]=o=>t.formData.proxy=o),placeholder:"请输入代理服务器地址，如：http://proxy:8080"},null,8,["value"])]),_:1}),a(n,{"wrapper-col":{span:16,offset:4}},{default:l(()=>[a(z,null,{default:l(()=>[a(i,{type:"primary",onClick:t.handleSubmit,loading:t.submitLoading},{default:l(()=>[...e[51]||(e[51]=[r(" 创建爬虫 ",-1)])]),_:1},8,["onClick","loading"]),a(i,{onClick:t.handleTest},{default:l(()=>[...e[52]||(e[52]=[r("测试连接",-1)])]),_:1},8,["onClick"]),a(i,{onClick:t.handleReset},{default:l(()=>[...e[53]||(e[53]=[r("重置表单",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}const te=G(Q,[["render",ee],["__scopeId","data-v-a8ad9fab"]]);export{te as default};
