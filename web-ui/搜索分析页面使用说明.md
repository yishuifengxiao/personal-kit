# 搜索分析页面使用说明

## 概述

搜索分析页面是时光后台系统的新增功能，用于记录和分析用户的搜索行为，包括搜索关键词、搜索结果、用户点击行为等数据，以便计算和评估搜索质量指标。

## 功能特点

### 1. 数据记录
- **搜索关键词**: 记录用户输入的搜索关键词
- **搜索结果**: 记录系统返回的搜索结果及序号
- **用户点击**: 记录用户实际点击的结果项和结果序号
- **用户信息**: 记录执行搜索的用户信息

### 2. 质量指标计算
- **准确率 (Accuracy)**: 正确预测的结果数占总预测结果数的比例
- **精确率 (Precision)**: 正确预测的正例数占预测为正例总数的比例
- **召回率 (Recall)**: 正确预测的正例数占实际正例总数的比例

### 3. 数据展示
- **统计卡片**: 顶部显示总搜索次数、平均准确率、平均精确率、平均召回率
- **数据表格**: 详细展示每条搜索记录的信息
- **进度条**: 使用彩色进度条直观显示各项指标

### 4. 数据筛选
- **关键词筛选**: 支持按搜索关键词模糊查询
- **用户筛选**: 支持按用户名称模糊查询
- **时间筛选**: 支持按时间范围筛选数据

### 5. 数据导出
- **Excel导出**: 支持将筛选后的数据导出为Excel文件
- **自定义导出**: 根据当前筛选条件导出对应数据

## 页面结构

### 搜索条件区域
```
┌─────────────────────────────────────────────────────────────┐
│ 搜索关键词: [________] 用户名称: [________]               │
│ 起始时间: [________] 结束时间: [________]                   │
│ [搜索] [重置] [导出]                                      │
└─────────────────────────────────────────────────────────────┘
```

### 统计信息区域
```
┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
│ 总搜索次数   │ │ 平均准确率   │ │ 平均精确率   │ │ 平均召回率   │
│    1,250     │ │    82.3%     │ │    76.8%     │ │    89.2%     │
└──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘
```

### 数据表格区域
```
┌────────────────────────────────────────────────────────────────────┐
│ ID │ 用户 │ 关键词 │ 搜索时间 │ 结果数 │ 点击序号 │ 准确率 │ 精确率 │ 召回率 │ 操作 │
├────────────────────────────────────────────────────────────────────┤
│ 1  │ 张三 │ 人工智能│ 2024-01-15│  156   │    3     │ 85.5% │ 78.2% │ 92.1% │ 详情 │
│ 2  │ 李四 │ 机器学习│ 2024-01-15│   89   │    1     │ 92.1% │ 85.7% │ 96.3% │ 详情 │
└────────────────────────────────────────────────────────────────────┘
```

## 使用方法

### 1. 访问页面
- 登录时光后台系统
- 在左侧菜单中选择"系统管理" → "搜索分析"
- 或直接访问：http://localhost:3001/#/sys/search_analyze

### 2. 查看统计数据
- 页面顶部显示4个统计卡片，展示整体搜索质量指标
- 统计卡片使用不同颜色标识，便于快速识别

### 3. 筛选数据
- 在搜索条件区域输入筛选条件
- 支持关键词、用户名称、时间范围等多种筛选方式
- 点击"搜索"按钮应用筛选条件
- 点击"重置"按钮清除所有筛选条件

### 4. 查看详情
- 点击数据表格中的"详情"按钮，弹出详细信息窗口
- 详情窗口显示完整的搜索记录信息
- 包括搜索时间、点击结果、各项指标等详细信息

### 5. 导出数据
- 设置好筛选条件后，点击"导出"按钮
- 系统会将当前筛选结果导出为Excel文件
- 文件包含所有可见字段的完整数据

### 6. 删除记录
- 点击数据表格中的"删除"按钮
- 系统会弹出确认对话框
- 确认后删除对应的搜索记录

## 技术实现

### 前端技术
- **框架**: Vue 3 + Composition API
- **UI组件**: Ant Design Vue
- **路由**: Vue Router
- **状态管理**: Pinia
- **HTTP请求**: Axios

### 后端接口
- **数据查询**: `/personkit/search/analyze/page`
- **数据导出**: `/personkit/search/analyze/export`
- **记录删除**: `/personkit/search/analyze/delete/{id}`

### 数据格式
- **时间格式**: 北京时间（YYYY-MM-DD HH:mm:ss）
- **百分比数据**: 0-100的数值形式
- **布尔数据**: true/false

## 注意事项

1. **权限控制**: 搜索分析页面需要管理员权限才能访问
2. **数据安全**: 导出的数据文件包含敏感信息，请妥善保管
3. **性能优化**: 大量数据导出时可能需要较长时间，请耐心等待
4. **数据准确性**: 确保搜索功能正确集成数据收集逻辑
5. **时间同步**: 确保系统时间准确，以保证数据分析的正确性

## 扩展功能

### 未来可添加的功能
1. **图表分析**: 添加趋势图、柱状图等可视化图表
2. **对比分析**: 支持不同时间段、不同用户群体的对比分析
3. **智能推荐**: 基于分析结果提供搜索优化建议
4. **实时监控**: 实时显示搜索质量和用户行为
5. **自定义报表**: 支持用户自定义报表格式和内容

## 问题排查

### 常见问题
1. **页面无法访问**: 检查路由配置和权限设置
2. **数据不显示**: 检查后端接口是否正常，网络连接是否畅通
3. **导出失败**: 检查浏览器下载权限和磁盘空间
4. **统计数据异常**: 检查数据收集逻辑是否正确实现

### 调试方法
1. 查看浏览器控制台错误信息
2. 检查网络请求状态和响应数据
3. 验证后端接口返回数据格式
4. 检查前端代码逻辑和状态管理